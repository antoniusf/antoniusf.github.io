var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function r(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(e,t){e.appendChild(t)}function a(e,t,n){e.insertBefore(t,n||null)}function l(e){e.parentNode.removeChild(e)}function c(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function u(e){return document.createElement(e)}function d(e){return document.createTextNode(e)}function f(){return d(" ")}function p(){return d("")}function h(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function m(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function g(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function y(e,t){e.value=null==t?"":t}function v(e,t,n){e.classList[n?"add":"remove"](t)}let w;function b(e){w=e}function k(e){(function(){if(!w)throw new Error("Function called outside component initialization");return w})().$$.on_mount.push(e)}const _=[],$=[],x=[],A=[],S=Promise.resolve();let T=!1;function q(e){x.push(e)}function K(e){A.push(e)}let E=!1;const W=new Set;function U(){if(!E){E=!0;do{for(let e=0;e<_.length;e+=1){const t=_[e];b(t),L(t.$$)}for(b(null),_.length=0;$.length;)$.pop()();for(let e=0;e<x.length;e+=1){const t=x[e];W.has(t)||(W.add(t),t())}x.length=0}while(_.length);for(;A.length;)A.pop()();T=!1,E=!1,W.clear()}}function L(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(q)}}const z=new Set;let O,P;function M(){O={r:0,c:[],p:O}}function N(){O.r||o(O.c),O=O.p}function C(e,t){e&&e.i&&(z.delete(e),e.i(t))}function D(e,t,n,o){if(e&&e.o){if(z.has(e))return;z.add(e),O.c.push(()=>{z.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}function R(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function B(e){e&&e.c()}function F(e,n,s){const{fragment:i,on_mount:a,on_destroy:l,after_update:c}=e.$$;i&&i.m(n,s),q(()=>{const n=a.map(t).filter(r);l?l.push(...n):o(n),e.$$.on_mount=[]}),c.forEach(q)}function j(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function H(e,t){-1===e.$$.dirty[0]&&(_.push(e),T||(T=!0,S.then(U)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function G(t,r,s,i,a,c,u=[-1]){const d=w;b(t);const f=r.props||{},p=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:n(),dirty:u,skip_bound:!1};let h=!1;if(p.ctx=s?s(t,f,(e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&a(p.ctx[e],p.ctx[e]=r)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](r),h&&H(t,e)),n}):[],p.update(),h=!0,o(p.before_update),p.fragment=!!i&&i(p.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);p.fragment&&p.fragment.l(e),e.forEach(l)}else p.fragment&&p.fragment.c();r.intro&&C(t.$$.fragment),F(t,r.target,r.anchor),U()}b(d)}class I{$destroy(){j(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class Y{constructor(e="keyval-store",t="keyval"){this.storeName=t,this._dbp=new Promise((n,o)=>{const r=indexedDB.open(e,1);r.onerror=()=>o(r.error),r.onsuccess=()=>n(r.result),r.onupgradeneeded=()=>{r.result.createObjectStore(t)}})}_withIDBStore(e,t){return this._dbp.then(n=>new Promise((o,r)=>{const s=n.transaction(this.storeName,e);s.oncomplete=()=>o(),s.onabort=s.onerror=()=>r(s.error),t(s.objectStore(this.storeName))}))}}function X(){return P||(P=new Y),P}function Z(e,t=X()){let n;return t._withIDBStore("readonly",t=>{n=t.get(e)}).then(()=>n.result)}function J(e,t,n=X()){return n._withIDBStore("readwrite",n=>{n.put(t,e)})}const Q=["#","S-","T-","K-","P-","W-","H-","R-","A","O","*","E","U","-F","-R","-P","-B","-L","-G","-T","-S","-D","-Z"],V={0:"O-",1:"S-",2:"T-",3:"P-",4:"H-",5:"A-",6:"-F",7:"-P",8:"-L",9:"-T"};function ee(e){let t="",n=!0;for(const o of Q)1&e&&("-"==o[0]&&n&&(t+="-",n=!1),t+=o.replace("-",""),o.includes("-")||"#"==o||(n=!1)),e>>=1;return t}function te(e){let t=[];for(let n=0;n<e.length;n+=3){let o=e[n]|e[n+1]<<8|e[n+2]<<16;t.push(ee(o))}return t.join("/")}function ne(e){let t=!1,n=0;for(const o of e){if("-"==o){t=!0;continue}let e=Q.indexOf(o);if(0==e);else if(e>0)t=!0;else if(e=t?Q.indexOf("-"+o):Q.indexOf(o+"-"),e<0){const t=V[o];if(!t){console.log("invalid key!");continue}n|=1,e=Q.indexOf(t)}n|=1<<e}return n}function oe(e){let t={};for(const n of Q)t[n]=1&e,e>>=1;return t}function re(e){if(e<0)throw RangeError("File size must be larger than 0!");let t=Math.log10(e)/3;t+=Math.log10(1e3/995)/3,t+=1/3,t=Math.floor(t);const n=Math.round(e/1e3**t*10)/10,o=["","k","M","G","T","P","E"];return t<o.length?n+" "+o[t]+"B":n+"e"+3*t+" B"}let se,ie=new TextDecoder("utf-8"),ae=new TextEncoder("utf-8");async function le(e){let t="./helpers.wasm";if(se||(se=WebAssembly.compileStreaming?WebAssembly.compileStreaming(fetch(t)).catch(e=>{throw`Oh no, there was a problem with loading the WebAssembly module. This is not good, since we can't do anything without that. (${e})`}):fetch(t).catch(e=>{throw`Couldn't load the wasm file for some reason. Sorry, this shouldn't happen. (${e})`}).then(e=>e.arrayBuffer()).then(e=>WebAssembly.compile(e)).catch(e=>{throw e instanceof TypeError?`Sorry, it seems like your browser does not support WebAssembly. We need this to make your queries fast while using as little of your precious RAM as possible. WebAssembly should be supported in the newest versions of all major browsers, except for Internet Explorer. (${e})`:e})),e){return ue(await ce(se),e)}}async function ce(e){let t,n,o=[];let r=await WebAssembly.instantiate(await e,{env:{logErr:function(e,o,r,s,i){if(t){const a=new Uint8Array(t.buffer,e,o),l=new Uint8Array(t.buffer,r,s),c=ie.decode(a),u=ie.decode(l);console.log(`WebAssembly module panicked with '${c} (${u})' on line ${i}`),n={message:c,details:u}}else console.log("Warning: logErr got called, but memory was not initialized??")},yield_result:function(e,n,r,s){let i=ie.decode(new Uint8Array(t.buffer,e,n)),a=new Uint8Array(t.buffer,r,s);o.push([te(a),i])}}});return t=r.exports.memory,{instance:r,results:o,get_last_error:function(){return n}}}function ue(e,t){let n=t.length;const o=n+100,r=Math.ceil(o/65536);let s=e.instance,i=e.results;const a=65536*s.exports.memory.grow(r),l=a+n;let c=new Uint8Array(s.exports.memory.buffer,a,n);c.set(t);let u=a;return{lookup:function(t){const n=performance.now(),o=ae.encode(t).subarray(0,100);new Uint8Array(s.exports.memory.buffer,l,o.length).set(o),i.splice(0,i.length);try{s.exports.query(l,o.length,u,0)}catch(t){let n=e.get_last_error();throw n||`Error in WebAssembly module: ${t} (this probably shouldn't have happened)`}return console.log(`query took ${performance.now()-n}ms`),i.slice()},find_strokes:function(t){const n=performance.now(),o=t.subarray(0,100);new Uint8Array(s.exports.memory.buffer,l,o.length).set(o),i.splice(0,i.length);try{s.exports.query(l,o.length,u,1)}catch(t){let n=e.get_last_error();throw n||`Error in WebAssembly module: ${t} (this probably shouldn't have happened)`}return console.log(`query took ${performance.now()-n}ms`),i.slice()},data:c}}function de(e){let t,n,o,r,s,c,p,y,v=e[0].name+"";return{c(){t=u("div"),n=u("p"),o=d("Current file: "),r=d(v),s=f(),c=u("button"),c.textContent="Remove",m(n,"class","svelte-uaenwa"),m(c,"class","svelte-uaenwa"),m(t,"id","loaded"),m(t,"class","svelte-uaenwa")},m(l,u){a(l,t,u),i(t,n),i(n,o),i(n,r),i(t,s),i(t,c),p||(y=h(c,"click",e[6]),p=!0)},p(e,t){1&t&&v!==(v=e[0].name+"")&&g(r,v)},d(e){e&&l(t),p=!1,y()}}}function fe(e){let t,n,o,r,s;function i(e,t){return"choosefile"==e[1]?he:"error"==e[1]||"reading"==e[1]?pe:void 0}let c=i(e),d=c&&c(e);return{c(){t=u("input"),n=f(),d&&d.c(),o=p(),m(t,"type","file"),m(t,"class","svelte-uaenwa")},m(i,l){a(i,t,l),a(i,n,l),d&&d.m(i,l),a(i,o,l),r||(s=h(t,"change",e[9]),r=!0)},p(e,t){c===(c=i(e))&&d?d.p(e,t):(d&&d.d(1),d=c&&c(e),d&&(d.c(),d.m(o.parentNode,o)))},d(e){e&&l(t),e&&l(n),d&&d.d(e),e&&l(o),r=!1,s()}}}function pe(e){let t,n,o,r,s=e[4]&&me(e);return{c(){t=u("p"),n=d(e[3]),o=f(),s&&s.c(),r=p(),m(t,"class","svelte-uaenwa")},m(e,l){a(e,t,l),i(t,n),a(e,o,l),s&&s.m(e,l),a(e,r,l)},p(e,t){8&t&&g(n,e[3]),e[4]?s?s.p(e,t):(s=me(e),s.c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d(e){e&&l(t),e&&l(o),s&&s.d(e),e&&l(r)}}}function he(t){let n,o,r;return{c(){n=u("p"),n.textContent="Please choose a dictionary from your device.",o=f(),r=u("p"),r.textContent="The dictionary will be stored inside of your browser, so you can access it when you load this page the next time. It will stay on your device only, and will not be sent anywhere else.",m(n,"class","svelte-uaenwa"),m(r,"id","smallstatus"),m(r,"class","svelte-uaenwa")},m(e,t){a(e,n,t),a(e,o,t),a(e,r,t)},p:e,d(e){e&&l(n),e&&l(o),e&&l(r)}}}function me(e){let t,n;return{c(){t=u("p"),n=d(e[4]),m(t,"id","smallstatus"),m(t,"class","svelte-uaenwa")},m(e,o){a(e,t,o),i(t,n)},p(e,t){16&t&&g(n,e[4])},d(e){e&&l(t)}}}function ge(e){let t,n,o,r,s,c,p,y=(e[2].date_checked?e[7].format(e[2].date_checked):"(unknown)")+"";return{c(){t=u("p"),n=d("Last checked: "),o=d(y),r=f(),s=u("button"),s.textContent="Check",m(t,"class","svelte-uaenwa"),m(s,"class","svelte-uaenwa")},m(l,u){a(l,t,u),i(t,n),i(t,o),a(l,r,u),a(l,s,u),c||(p=h(s,"click",e[11]),c=!0)},p(e,t){4&t&&y!==(y=(e[2].date_checked?e[7].format(e[2].date_checked):"(unknown)")+"")&&g(o,y)},d(e){e&&l(t),e&&l(r),e&&l(s),c=!1,p()}}}function ye(e){let t,n,o,r,s,c,p,y,v=re(e[2].update_size)+"";return{c(){t=u("p"),n=d("Update available ("),o=d(v),r=d(")"),s=f(),c=u("button"),c.textContent="Update!",m(t,"class","svelte-uaenwa"),m(c,"class","svelte-uaenwa")},m(l,u){a(l,t,u),i(t,n),i(t,o),i(t,r),a(l,s,u),a(l,c,u),p||(y=h(c,"click",e[10]),p=!0)},p(e,t){4&t&&v!==(v=re(e[2].update_size)+"")&&g(o,v)},d(e){e&&l(t),e&&l(s),e&&l(c),p=!1,y()}}}function ve(e){let t,n,o=e[2].serviceworker_info+"";return{c(){t=u("p"),n=d(o),m(t,"id","update-info"),m(t,"class","svelte-uaenwa")},m(e,o){a(e,t,o),i(t,n)},p(e,t){4&t&&o!==(o=e[2].serviceworker_info+"")&&g(n,o)},d(e){e&&l(t)}}}function we(t){let n,o,r,s,i,c;function d(e,t){return null===e[0]?fe:de}let h=d(t),g=h(t);function y(e,t){return e[2].update_available?ye:ge}let v=y(t),w=v(t),b=t[2].serviceworker_info&&ve(t);return{c(){g.c(),n=f(),o=u("h2"),o.textContent="Updates",r=f(),s=u("div"),w.c(),i=f(),b&&b.c(),c=p(),m(o,"class","svelte-uaenwa"),m(s,"id","updates"),m(s,"class","svelte-uaenwa")},m(e,t){g.m(e,t),a(e,n,t),a(e,o,t),a(e,r,t),a(e,s,t),w.m(s,null),a(e,i,t),b&&b.m(e,t),a(e,c,t)},p(e,[t]){h===(h=d(e))&&g?g.p(e,t):(g.d(1),g=h(e),g&&(g.c(),g.m(n.parentNode,n))),v===(v=y(e))&&w?w.p(e,t):(w.d(1),w=v(e),w&&(w.c(),w.m(s,null))),e[2].serviceworker_info?b?b.p(e,t):(b=ve(e),b.c(),b.m(c.parentNode,c)):b&&(b.d(1),b=null)},i:e,o:e,d(e){g.d(e),e&&l(n),e&&l(o),e&&l(r),e&&l(s),w.d(),e&&l(i),b&&b.d(e),e&&l(c)}}}function be(e,t,n){let{dictionary:o}=t,{status:r}=t,{app_status:s}=t,{update_info:i}=t,a="",l="",c=[];async function u(e){n(3,a="Organizing data..."),n(4,l="");try{n(0,o=await async function(e){le();const t=await ce(se),n=t.instance,o=ae.encode(e),r=Math.ceil(o.length/65536),s=n.exports.memory.grow(r),i=65536*s;console.log("number of base pages: "+s),new Uint8Array(n.exports.memory.buffer).subarray(i,i+o.length).set(o),console.log("before wasm");const a=performance.now();let l;try{l=n.exports.load_json(i,o.length)}catch(e){let n=t.get_last_error();throw n||`Error in WebAssembly module: ${e} (this probably shouldn't have happened)`}console.log(`after wasm (took ${performance.now()-a}ms)`);const c=new Uint32Array(n.exports.memory.buffer,l,3),u=12+4*c[1]+c[2];console.log("data length: "+u);const d=new Uint8Array(n.exports.memory.buffer,l,u).slice();return ue(await ce(se),d)}(e.result))}catch(e){return console.log(e),n(1,r="error"),e.message||(e={message:"An error occured while trying to load your dictionary.",details:""+e}),n(3,a=e.message),void n(4,l=e.details)}n(0,o.name=c[0].name,o),await J("dictionary",{name:o.name,data:o.data}),n(1,r="loaded"),n(8,s="query"),n(3,a=""),n(4,l="")}k(async()=>{if("initializing"==r){let e=await Z("dictionary");if(e){try{n(0,o=await le(e.data))}catch(e){return n(1,r="error"),n(3,a="Error occured while trying to load stored dictionary."),void n(4,l=""+e)}n(0,o.name=e.name,o),n(1,r="loaded"),n(8,s="query")}else n(1,r="choosefile")}});const d=new Intl.DateTimeFormat(void 0,{month:"long",day:"numeric",hour:"numeric",minute:"numeric"});return e.$$set=e=>{"dictionary"in e&&n(0,o=e.dictionary),"status"in e&&n(1,r=e.status),"app_status"in e&&n(8,s=e.app_status),"update_info"in e&&n(2,i=e.update_info)},e.$$.update=()=>{32&e.$$.dirty&&function(e){if(e.length>0){let t=e[0];if(t.size>10485760)n(1,r="error"),n(3,a="Sorry, we only accept files up to 10MB currently."),n(4,l="");else if("application/json"!=t.type)n(1,r="error"),n(3,a="Sorry, right now we can only read plover json dictionaries."),n(4,l="");else{n(1,r="reading"),n(3,a="Loading... 0%"),n(4,l="");let e=new FileReader;e.addEventListener("load",t=>u(e)),e.addEventListener("progress",e=>{let t=Math.floor(e.loaded/e.total*100);n(3,a=`Loading... ${t}%`)}),e.addEventListener("abort",e=>{n(1,r="error"),n(3,a="Aborted."),n(4,l="")}),e.addEventListener("error",e=>{n(1,r="error"),n(3,a="Your browser failed to load the file. Please try again."),n(4,l="")}),e.readAsText(t)}}}(c)},[o,r,i,a,l,c,async function(e){n(0,o=null),await function(e,t=X()){return t._withIDBStore("readwrite",t=>{t.delete(e)})}("dictionary"),n(1,r="choosefile")},d,s,function(){c=this.files,n(5,c)},e=>navigator.serviceWorker.controller.postMessage("do-update"),e=>navigator.serviceWorker.controller.postMessage("check-for-updates")]}class ke extends I{constructor(e){super(),G(this,e,be,we,s,{dictionary:0,status:1,app_status:8,update_info:2})}}function _e(e,t,n){const o=e.slice();return o[1]=t[n][0],o[2]=t[n][1],o}function $e(e){let t,n=e[0],o=[];for(let t=0;t<n.length;t+=1)o[t]=Ae(_e(e,n,t));return{c(){t=u("table");for(let e=0;e<o.length;e+=1)o[e].c();m(t,"class","svelte-1tqx9ii")},m(e,n){a(e,t,n);for(let e=0;e<o.length;e+=1)o[e].m(t,null)},p(e,r){if(1&r){let s;for(n=e[0],s=0;s<n.length;s+=1){const i=_e(e,n,s);o[s]?o[s].p(i,r):(o[s]=Ae(i),o[s].c(),o[s].m(t,null))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(e){e&&l(t),c(o,e)}}}function xe(t){let n;return{c(){n=u("p"),n.textContent="(no results)",m(n,"class","svelte-1tqx9ii")},m(e,t){a(e,n,t)},p:e,d(e){e&&l(n)}}}function Ae(e){let t,n,o,r,s,c=e[1]+"",f=e[2]+"";return{c(){t=u("tr"),n=u("td"),o=d(c),r=u("td"),s=d(f),m(n,"class","strokes svelte-1tqx9ii"),m(r,"class","svelte-1tqx9ii"),m(t,"class","svelte-1tqx9ii")},m(e,l){a(e,t,l),i(t,n),i(n,o),i(t,r),i(r,s)},p(e,t){1&t&&c!==(c=e[1]+"")&&g(o,c),1&t&&f!==(f=e[2]+"")&&g(s,f)},d(e){e&&l(t)}}}function Se(t){let n;function o(e,t){return 0==e[0].length?xe:$e}let r=o(t),s=r(t);return{c(){s.c(),n=p()},m(e,t){s.m(e,t),a(e,n,t)},p(e,[t]){r===(r=o(e))&&s?s.p(e,t):(s.d(1),s=r(e),s&&(s.c(),s.m(n.parentNode,n)))},i:e,o:e,d(e){s.d(e),e&&l(n)}}}function Te(e,t,n){let{results:o=[]}=t;return e.$$set=e=>{"results"in e&&n(0,o=e.results)},[o]}class qe extends I{constructor(e){super(),G(this,e,Te,Se,s,{results:0})}}function Ke(t){let n,o,r,s,c=t[2].message+"",h=t[2].details&&We(t);return{c(){n=u("p"),o=d(c),r=f(),h&&h.c(),s=p(),m(n,"id","bigerror"),m(n,"class","svelte-asd7nl")},m(e,t){a(e,n,t),i(n,o),a(e,r,t),h&&h.m(e,t),a(e,s,t)},p(e,t){4&t&&c!==(c=e[2].message+"")&&g(o,c),e[2].details?h?h.p(e,t):(h=We(e),h.c(),h.m(s.parentNode,s)):h&&(h.d(1),h=null)},i:e,o:e,d(e){e&&l(n),e&&l(r),h&&h.d(e),e&&l(s)}}}function Ee(e){let t,n;return t=new qe({props:{results:e[1]}}),{c(){B(t.$$.fragment)},m(e,o){F(t,e,o),n=!0},p(e,n){const o={};2&n&&(o.results=e[1]),t.$set(o)},i(e){n||(C(t.$$.fragment,e),n=!0)},o(e){D(t.$$.fragment,e),n=!1},d(e){j(t,e)}}}function We(e){let t,n,o=e[2].details+"";return{c(){t=u("p"),n=d(o),m(t,"id","smallerror"),m(t,"class","svelte-asd7nl")},m(e,o){a(e,t,o),i(t,n)},p(e,t){4&t&&o!==(o=e[2].details+"")&&g(n,o)},d(e){e&&l(t)}}}function Ue(e){let t,n,o,r,s,i,c,d;const g=[Ee,Ke],v=[];function w(e,t){return void 0!==e[1]?0:e[2]?1:-1}return~(o=w(e))&&(r=v[o]=g[o](e)),{c(){t=u("input"),n=f(),r&&r.c(),s=p(),m(t,"id","query-input"),m(t,"type","text"),m(t,"aria-labelledby","mode-label"),m(t,"autocapitalize","none"),m(t,"class","svelte-asd7nl")},m(r,l){a(r,t,l),y(t,e[0]),a(r,n,l),~o&&v[o].m(r,l),a(r,s,l),i=!0,c||(d=h(t,"input",e[4]),c=!0)},p(e,[n]){1&n&&t.value!==e[0]&&y(t,e[0]);let i=o;o=w(e),o===i?~o&&v[o].p(e,n):(r&&(M(),D(v[i],1,1,()=>{v[i]=null}),N()),~o?(r=v[o],r||(r=v[o]=g[o](e),r.c()),C(r,1),r.m(s.parentNode,s)):r=null)},i(e){i||(C(r),i=!0)},o(e){D(r),i=!1},d(e){e&&l(t),e&&l(n),~o&&v[o].d(e),e&&l(s),c=!1,d()}}}function Le(e,t,n){let o,{dictionary:r}=t,s="",i=[];return e.$$set=e=>{"dictionary"in e&&n(3,r=e.dictionary)},e.$$.update=()=>{1&e.$$.dirty&&function(e){n(2,o=void 0),n(1,i=void 0);try{n(1,i=r.lookup(e)),console.log("asdf "+i)}catch(e){n(1,i=void 0),e.message?n(2,o=e):n(2,o={message:e.toString()})}}(s)},[s,i,o,r,function(){s=this.value,n(0,s)}]}class ze extends I{constructor(e){super(),G(this,e,Le,Ue,s,{dictionary:3})}}function Oe(e,t,n){const o=e.slice();return o[30]=t[n],o[31]=t,o[32]=n,o}function Pe(e){let t,n,r,s,i,c,d,f=e[30];const p=()=>e[19](t,f),g=()=>e[19](null,f);return{c(){t=u("button"),m(t,"id",n=e[7][e[30]]||e[30]),m(t,"aria-label",r=e[8][e[30]]),m(t,"aria-pressed",s=!!e[5][e[30]]),m(t,"tabindex",i=e[9][e[3][0]][e[3][1]]==e[30]?0:-1),m(t,"class","steno svelte-1o1sqid"),v(t,"long-key","S-"==e[30]||"*"==e[30]),v(t,"top-row",1==e[1][e[30]][0]),v(t,"bottom-row",2==e[1][e[30]][0]),v(t,"left-vowel","A"==e[30]||"O"==e[30]),v(t,"right-vowel","E"==e[30]||"U"==e[30])},m(n,o){var r;a(n,t,o),p(),c||(d=[h(t,"click",e[14]),h(t,"touchstart",(r=e[11],function(e){return e.preventDefault(),r.call(this,e)})),h(t,"touchmove",e[12]),h(t,"touchend",e[13]),h(t,"touchcancel",e[13]),h(t,"keydown",e[15]),h(t,"keyup",e[16]),h(t,"focus",e[17])],c=!0)},p(n,o){e=n,32&o[0]&&s!==(s=!!e[5][e[30]])&&m(t,"aria-pressed",s),8&o[0]&&i!==(i=e[9][e[3][0]][e[3][1]]==e[30]?0:-1)&&m(t,"tabindex",i),f!==e[30]&&(g(),f=e[30],p()),64&o[0]&&v(t,"long-key","S-"==e[30]||"*"==e[30]),66&o[0]&&v(t,"top-row",1==e[1][e[30]][0]),66&o[0]&&v(t,"bottom-row",2==e[1][e[30]][0]),64&o[0]&&v(t,"left-vowel","A"==e[30]||"O"==e[30]),64&o[0]&&v(t,"right-vowel","E"==e[30]||"U"==e[30])},d(e){e&&l(t),g(),c=!1,o(d)}}}function Me(t){let n,r,s,p,g,y,v,w,b,k,_,$,x,A,S,T,q,K,E,W,U,L,z,O,P,M,N,C,D,R=t[6],B=[];for(let e=0;e<R.length;e+=1)B[e]=Pe(Oe(t,R,e));return{c(){n=u("button"),r=u("img"),p=f(),g=u("span"),g.textContent="virtual stenotype help",y=f(),v=u("div"),w=u("p"),w.textContent='The virtual stenotype always shows the last stroke of the search box. Use "add" to add a new, empty stroke, and "delete" to remove the current stroke and go back to the previous one.',b=f(),k=u("p"),k.innerHTML="<b>Mouse:</b> Click keys to toggle them.",_=f(),$=u("p"),$.innerHTML="<b>Touch:</b> Touch or swipe over keys to toggle them.",x=f(),A=u("p"),A.innerHTML="<b>Keyboard:</b> Use arrow keys to move between buttons, and space or return to toggle.",S=f(),T=u("p"),T.innerHTML="<b>Keyboard (direct input):</b> Move focus to any button, then use a your keyboard as a qwerty stenotype. Pressing a key will add it to the chord; to clear the entire chord, use backspace.",K=f(),E=u("div");for(let e=0;e<B.length;e+=1)B[e].c();W=f(),U=u("button"),L=d("delete"),O=f(),P=u("button"),M=d("add"),r.src!==(s=t[4]?"collapse-icon.svg":"expand-icon.svg")&&m(r,"src",s),m(r,"alt",""),m(r,"class","svelte-1o1sqid"),m(g,"class","svelte-1o1sqid"),m(n,"class","keyboard-help-toggle svelte-1o1sqid"),m(n,"aria-expanded",t[4]),m(w,"class","steno-keyboard-hint svelte-1o1sqid"),m(k,"class","steno-keyboard-hint svelte-1o1sqid"),m($,"class","steno-keyboard-hint svelte-1o1sqid"),m(A,"class","steno-keyboard-hint svelte-1o1sqid"),m(T,"class","steno-keyboard-hint svelte-1o1sqid"),m(v,"id","steno-keyboard-hint-container"),v.hidden=q=!t[4],m(v,"class","svelte-1o1sqid"),m(U,"id","delete-stroke"),m(U,"tabindex",z="pr"==t[9][t[3][0]][t[3][1]]?0:-1),m(U,"class","steno-action svelte-1o1sqid"),m(P,"id","new-stroke"),m(P,"tabindex",N="ne"==t[9][t[3][0]][t[3][1]]?0:-1),m(P,"class","steno-action svelte-1o1sqid"),m(E,"id","steno-keyboard"),m(E,"role","group"),m(E,"aria-label","steno keyboard"),m(E,"class","svelte-1o1sqid")},m(e,o){a(e,n,o),i(n,r),i(n,p),i(n,g),a(e,y,o),a(e,v,o),i(v,w),i(v,b),i(v,k),i(v,_),i(v,$),i(v,x),i(v,A),i(v,S),i(v,T),a(e,K,o),a(e,E,o);for(let e=0;e<B.length;e+=1)B[e].m(E,null);i(E,W),i(E,U),i(U,L),t[21](U),i(E,O),i(E,P),i(P,M),t[23](P),C||(D=[h(n,"click",t[18]),h(U,"click",t[20]),h(U,"keydown",t[15]),h(U,"keyup",t[16]),h(U,"focus",t[17]),h(P,"click",t[22]),h(P,"keydown",t[15]),h(P,"keyup",t[16]),h(P,"focus",t[17])],C=!0)},p(e,t){if(16&t[0]&&r.src!==(s=e[4]?"collapse-icon.svg":"expand-icon.svg")&&m(r,"src",s),16&t[0]&&m(n,"aria-expanded",e[4]),16&t[0]&&q!==(q=!e[4])&&(v.hidden=q),261102&t[0]){let n;for(R=e[6],n=0;n<R.length;n+=1){const o=Oe(e,R,n);B[n]?B[n].p(o,t):(B[n]=Pe(o),B[n].c(),B[n].m(E,W))}for(;n<B.length;n+=1)B[n].d(1);B.length=R.length}8&t[0]&&z!==(z="pr"==e[9][e[3][0]][e[3][1]]?0:-1)&&m(U,"tabindex",z),8&t[0]&&N!==(N="ne"==e[9][e[3][0]][e[3][1]]?0:-1)&&m(P,"tabindex",N)},i:e,o:e,d(e){e&&l(n),e&&l(y),e&&l(v),e&&l(K),e&&l(E),c(B,e),t[21](null),t[23](null),C=!1,o(D)}}}function Ne(e,t,n){const o=["#","S-","T-","K-","P-","W-","H-","R-","A","O","*","E","U","-F","-R","-P","-B","-L","-G","-T","-S","-D","-Z"],r={number:"#",star:"*","new-stroke":"ne","delete-stroke":"pr"},s=[["#","#","#","#","#","#","#","#","#","#"],["S-","T-","P-","H-","*","-F","-P","-L","-T","-D"],["S-","K-","W-","R-","*","-R","-B","-G","-S","-Z"],["pr","pr","A","O",null,"E","U",null,"ne","ne"]];let i={};for(let e=0;e<s.length;e++){let t=s[e];for(let n=0;n<t.length;n++){let o=t[n];o&&!i[o]&&(i[o]=[e,n])}}let a={KeyQ:"S-",KeyA:"S-",KeyW:"T-",KeyS:"K-",KeyE:"P-",KeyD:"W-",KeyR:"H-",KeyF:"R-",KeyC:"A",KeyV:"O",KeyT:"*",KeyG:"*",KeyY:"*",KeyH:"*",KeyN:"E",KeyM:"U",KeyU:"-F",KeyJ:"-R",KeyI:"-P",KeyK:"-B",KeyO:"-L",KeyL:"-G",KeyP:"-T",Semicolon:"-S",BracketLeft:"-D",Quote:"-Z"};const l={};let c=[0,0],u=!1,d={};for(const e of o)d[e]=!1;let{strokes:f=[0]}=t;function p(){console.log(d);const e=function(e){let t=0,n=1;for(const o of Q)e.includes(o)&&(t|=n),n<<=1;return t}(Object.entries(d).filter(([e,t])=>t).map(([e,t])=>e));n(0,f[f.length-1]=e,f)}let h={},m=null;function g(e){const t=s[c[0]][c[1]];let o=c.slice(),r=t;for(;!r||r==t;){if(o=[o[0]+e[0],o[1]+e[1]],o[0]<0||o[0]>=s.length||o[1]<0||o[1]>=s[0].length)return;r=s[o[0]][o[1]]}l[r].focus(),n(3,c=o),console.log(c)}return e.$$set=e=>{"strokes"in e&&n(0,f=e.strokes)},e.$$.update=()=>{1&e.$$.dirty[0]&&n(5,d=oe(f[f.length-1]))},[f,i,l,c,u,d,o,{"#":"number","*":"star",pr:"delete-stroke",ne:"new-stroke"},{"#":"number bar","S-":"left S","T-":"left T","K-":"left K","P-":"left P","W-":"left W","H-":"left H","R-":"left R",A:"A",O:"O","*":"asterisk",E:"E",U:"U","-F":"right F","-R":"right R","-P":"right P","-B":"right B","-L":"right L","-G":"right G","-T":"right T","-S":"right S","-D":"right D","-Z":"right Z"},s,p,function(e){e.touches;for(let t=0;t<e.touches.length;t++){let o=e.touches[t];if(!h.hasOwnProperty(o.identifier)){let t=r[e.target.id]||e.target.id;n(5,d[t]^=!0,d);let s=d[t];console.log("new touch with mode "+s),h[o.identifier]={x:o.clientX,y:o.clientY,mode:s}}}p()},function(e){let t=e.changedTouches,o=!1;for(let e=0;e<t.length;e++){let s=t[e],i=h[s.identifier];if(!i)continue;let a=window.innerWidth/20,l=s.clientX-i.x,c=s.clientY-i.y,u=Math.sqrt(l**2+c**2),f=l/u*a,p=c/u*a;for(;u>0;){let e=i.x+l,t=i.y+c;u-=a,l-=f,c-=p;let s=document.elementFromPoint(e,t),h=r[s.id]||s.id;d.hasOwnProperty(h)&&d[h]!=i.mode&&(n(5,d[h]=i.mode,d),o=!0)}i.x=s.clientX,i.y=s.clientY}o&&p()},function(e){let t=e.changedTouches;for(let e=0;e<t.length;e++)delete h[t[e].identifier];m={x:t[t.length-1].clientX,y:t[t.length-1].clientY,target:t[t.length-1].target},console.log(m)},function(e){if(console.log(`x: ${e.clientX}, y: ${e.clientY}`),null!==m){if(e.target==m.target&&m.x==e.clientX&&m.y==e.clientY)return void(m=null);m=null}const t=r[e.target.id]||e.target.id;n(5,d[t]^=!0,d),p()},function(e){switch(e.key){case"Down":case"ArrowDown":g([1,0]),e.preventDefault();break;case"Up":case"ArrowUp":g([-1,0]),e.preventDefault();break;case"Left":case"ArrowLeft":g([0,-1]);break;case"Right":case"ArrowRight":g([0,1]);break;case"Backspace":for(const e of o)n(5,d[e]=0,d);p();break;default:let t=a[e.code];t&&(n(5,d[t]=1,d),p())}},function(e){a[e.code]&&p()},function(e){let t=r[e.target.id]||e.target.id;n(3,c=i[t]),console.log(`changed focus to ${c} (button name ${t})`)},e=>{n(4,u=!u)},function(e,t){$[e?"unshift":"push"](()=>{l[t]=e,n(2,l),n(6,o)})},e=>{f.pop(),0==f.length&&f.push(0),n(5,d=oe(f[f.length-1])),n(0,f),p()},function(e){$[e?"unshift":"push"](()=>{l.pr=e,n(2,l)})},e=>{0!=f[f.length-1]&&(f.push(0),n(5,d=oe(f[f.length-1])),n(0,f),p())},function(e){$[e?"unshift":"push"](()=>{l.ne=e,n(2,l)})}]}class Ce extends I{constructor(e){super(),G(this,e,Ne,Me,s,{strokes:0},[-1,-1])}}function De(t){let n,o,r,s,c=t[3].message+"",h=t[3].details&&Be(t);return{c(){n=u("p"),o=d(c),r=f(),h&&h.c(),s=p(),m(n,"id","bigerror")},m(e,t){a(e,n,t),i(n,o),a(e,r,t),h&&h.m(e,t),a(e,s,t)},p(e,t){8&t&&c!==(c=e[3].message+"")&&g(o,c),e[3].details?h?h.p(e,t):(h=Be(e),h.c(),h.m(s.parentNode,s)):h&&(h.d(1),h=null)},i:e,o:e,d(e){e&&l(n),e&&l(r),h&&h.d(e),e&&l(s)}}}function Re(e){let t,n;return t=new qe({props:{results:e[2]}}),{c(){B(t.$$.fragment)},m(e,o){F(t,e,o),n=!0},p(e,n){const o={};4&n&&(o.results=e[2]),t.$set(o)},i(e){n||(C(t.$$.fragment,e),n=!0)},o(e){D(t.$$.fragment,e),n=!1},d(e){j(t,e)}}}function Be(e){let t,n,o=e[3].details+"";return{c(){t=u("p"),n=d(o),m(t,"id","smallerror"),m(t,"class","svelte-y68lui")},m(e,o){a(e,t,o),i(t,n)},p(e,t){8&t&&o!==(o=e[3].details+"")&&g(n,o)},d(e){e&&l(t)}}}function Fe(e){let t,n,o,r,s,i,c,d,g,y,v;function w(t){e[6].call(null,t)}let b={};void 0!==e[0]&&(b.strokes=e[0]),t=new Ce({props:b}),$.push(()=>R(t,"strokes",w));const k=[Re,De],_=[];function x(e,t){return void 0!==e[2]?0:e[3]?1:-1}return~(i=x(e))&&(c=_[i]=k[i](e)),{c(){B(t.$$.fragment),o=f(),r=u("input"),s=f(),c&&c.c(),d=p(),m(r,"type","text"),m(r,"aria-labelledby","mode-label"),m(r,"class","svelte-y68lui")},m(n,l){F(t,n,l),a(n,o,l),a(n,r,l),e[7](r),a(n,s,l),~i&&_[i].m(n,l),a(n,d,l),g=!0,y||(v=h(r,"input",e[4]),y=!0)},p(e,[o]){const r={};!n&&1&o&&(n=!0,r.strokes=e[0],K(()=>n=!1)),t.$set(r);let s=i;i=x(e),i===s?~i&&_[i].p(e,o):(c&&(M(),D(_[s],1,1,()=>{_[s]=null}),N()),~i?(c=_[i],c||(c=_[i]=k[i](e),c.c()),C(c,1),c.m(d.parentNode,d)):c=null)},i(e){g||(C(t.$$.fragment,e),C(c),g=!0)},o(e){D(t.$$.fragment,e),D(c),g=!1},d(n){j(t,n),n&&l(o),n&&l(r),e[7](null),n&&l(s),~i&&_[i].d(n),n&&l(d),y=!1,v()}}}function je(e,t,n){let o,r,{dictionary:s}=t,i=[0],a="",l=[];async function c(){n(3,r=void 0),n(2,l=void 0);try{n(2,l=s.find_strokes(function(e){let t=[];for(const n of e)t.push(255&n),t.push(n>>8&255),t.push(n>>16&255);return new Uint8Array(t)}(i)))}catch(e){n(2,l=void 0),e.message?n(3,r=e):n(3,r={message:e.toString()})}}return e.$$set=e=>{"dictionary"in e&&n(5,s=e.dictionary)},e.$$.update=()=>{259&e.$$.dirty&&(n(8,a=i.map(ee).join("/")),o&&o.value!=a&&n(1,o.value=a,o),c())},[i,o,l,r,function(e){const t=e.target.value;t!=a&&(n(8,a=t),n(0,i=a.toUpperCase().split("/").map(ne)),c())},s,function(e){i=e,n(0,i)},function(e){$[e?"unshift":"push"](()=>{o=e,n(1,o),n(0,i),n(8,a)})}]}class He extends I{constructor(e){super(),G(this,e,je,Fe,s,{dictionary:5})}}function Ge(e){let t;return{c(){t=u("div"),m(t,"id","notification-marker"),m(t,"class","svelte-zn3s74")},m(e,n){a(e,t,n)},d(e){e&&l(t)}}}function Ie(e){let t,n,o,r;const s=[Je,Ze],i=[];function c(e,t){return null===e[4]?0:1}return t=c(e),n=i[t]=s[t](e),{c(){n.c(),o=p()},m(e,n){i[t].m(e,n),a(e,o,n),r=!0},p(e,r){let a=t;t=c(e),t===a?i[t].p(e,r):(M(),D(i[a],1,1,()=>{i[a]=null}),N(),n=i[t],n||(n=i[t]=s[t](e),n.c()),C(n,1),n.m(o.parentNode,o))},i(e){r||(C(n),r=!0)},o(e){D(n),r=!1},d(e){i[t].d(e),e&&l(o)}}}function Ye(e){let t,n,o,r;const s=[Ve,Qe],i=[];function c(e,t){return null===e[4]?0:1}return t=c(e),n=i[t]=s[t](e),{c(){n.c(),o=p()},m(e,n){i[t].m(e,n),a(e,o,n),r=!0},p(e,r){let a=t;t=c(e),t===a?i[t].p(e,r):(M(),D(i[a],1,1,()=>{i[a]=null}),N(),n=i[t],n||(n=i[t]=s[t](e),n.c()),C(n,1),n.m(o.parentNode,o))},i(e){r||(C(n),r=!0)},o(e){D(n),r=!1},d(e){i[t].d(e),e&&l(o)}}}function Xe(e){let t,n,o,r,s,i;function a(t){e[9].call(null,t)}function l(t){e[10].call(null,t)}function c(t){e[11].call(null,t)}function u(t){e[12].call(null,t)}let d={};return void 0!==e[4]&&(d.dictionary=e[4]),void 0!==e[2]&&(d.update_info=e[2]),void 0!==e[1]&&(d.status=e[1]),void 0!==e[0]&&(d.app_status=e[0]),t=new ke({props:d}),$.push(()=>R(t,"dictionary",a)),$.push(()=>R(t,"update_info",l)),$.push(()=>R(t,"status",c)),$.push(()=>R(t,"app_status",u)),{c(){B(t.$$.fragment)},m(e,n){F(t,e,n),i=!0},p(e,i){const a={};!n&&16&i&&(n=!0,a.dictionary=e[4],K(()=>n=!1)),!o&&4&i&&(o=!0,a.update_info=e[2],K(()=>o=!1)),!r&&2&i&&(r=!0,a.status=e[1],K(()=>r=!1)),!s&&1&i&&(s=!0,a.app_status=e[0],K(()=>s=!1)),t.$set(a)},i(e){i||(C(t.$$.fragment,e),i=!0)},o(e){D(t.$$.fragment,e),i=!1},d(e){j(t,e)}}}function Ze(e){let t,n,o;function r(t){e[14].call(null,t)}let s={};return void 0!==e[4]&&(s.dictionary=e[4]),t=new He({props:s}),$.push(()=>R(t,"dictionary",r)),{c(){B(t.$$.fragment)},m(e,n){F(t,e,n),o=!0},p(e,o){const r={};!n&&16&o&&(n=!0,r.dictionary=e[4],K(()=>n=!1)),t.$set(r)},i(e){o||(C(t.$$.fragment,e),o=!0)},o(e){D(t.$$.fragment,e),o=!1},d(e){j(t,e)}}}function Je(t){let n,o;return{c(){n=d("// TODO: un-duplicate this code\n        "),o=u("p"),o.textContent="No dictionary loaded.",m(o,"id","nodict"),m(o,"class","svelte-zn3s74")},m(e,t){a(e,n,t),a(e,o,t)},p:e,i:e,o:e,d(e){e&&l(n),e&&l(o)}}}function Qe(e){let t,n,o;function r(t){e[13].call(null,t)}let s={};return void 0!==e[4]&&(s.dictionary=e[4]),t=new ze({props:s}),$.push(()=>R(t,"dictionary",r)),{c(){B(t.$$.fragment)},m(e,n){F(t,e,n),o=!0},p(e,o){const r={};!n&&16&o&&(n=!0,r.dictionary=e[4],K(()=>n=!1)),t.$set(r)},i(e){o||(C(t.$$.fragment,e),o=!0)},o(e){D(t.$$.fragment,e),o=!1},d(e){j(t,e)}}}function Ve(t){let n;return{c(){n=u("p"),n.textContent="No dictionary loaded.",m(n,"id","nodict"),m(n,"class","svelte-zn3s74")},m(e,t){a(e,n,t)},p:e,i:e,o:e,d(e){e&&l(n)}}}function et(e){let t,n,r,s,c,p,y,v,w,b,k,_,$,x,A,S,T,q,K,E,W,U,L,z,O,P,R,B,F,j,H,G,I,Y,X,Z,J,Q,V,ee,te=e[5][e[0]]+"",ne=e[2].new_version&&"unknown"!=e[2].user_knows_about_this_version&&e[2].user_knows_about_this_version!=e[2].new_version&&Ge();const oe=[Xe,Ye,Ie],re=[];function se(e,t){return"load-dict"==e[0]?0:"query"==e[0]?1:"find-stroke"==e[0]?2:-1}return~(R=se(e))&&(B=re[R]=oe[R](e)),{c(){t=u("div"),n=u("header"),r=u("h1"),s=d(te),c=f(),p=u("nav"),y=u("button"),v=u("img"),_=f(),$=u("button"),x=u("img"),q=f(),K=u("button"),E=u("img"),U=f(),ne&&ne.c(),O=f(),P=u("main"),B&&B.c(),F=f(),j=u("p"),H=d("App version: 0.0.24"),G=u("br"),I=d("Updater version: "),Y=d(e[3]),X=u("br"),Z=d("File a bug or contribute to development on "),J=u("a"),J.textContent="github",m(r,"id","mode-label"),m(r,"aria-live","polite"),m(r,"class","svelte-zn3s74"),v.src!==(w="abc-icon.svg")&&m(v,"src","abc-icon.svg"),m(v,"alt","lookup"),m(v,"class","svelte-zn3s74"),m(y,"aria-current",b="query"==e[0]),y.disabled=k=null==e[4],m(y,"class","svelte-zn3s74"),x.src!==(A="STK-icon.svg")&&m(x,"src","STK-icon.svg"),m(x,"alt","find stroke"),m(x,"class","svelte-zn3s74"),m($,"aria-current",S="find-stroke"==e[0]),$.disabled=T=null==e[4],m($,"class","svelte-zn3s74"),E.src!==(W="load-icon.svg")&&m(E,"src","load-icon.svg"),m(E,"alt","load"),m(E,"class","svelte-zn3s74"),m(K,"id","load"),m(K,"aria-current",L="load-dict"==e[0]),K.disabled=z=null==e[4],m(K,"class","svelte-zn3s74"),m(p,"class","svelte-zn3s74"),m(n,"class","svelte-zn3s74"),m(J,"href","https://github.com/antoniusf/steno-lookup"),m(J,"target","_blank"),m(j,"id","version-info"),m(j,"class","svelte-zn3s74"),m(t,"id","container"),m(t,"class","svelte-zn3s74")},m(o,l){a(o,t,l),i(t,n),i(n,r),i(r,s),i(n,c),i(n,p),i(p,y),i(y,v),i(p,_),i(p,$),i($,x),i(p,q),i(p,K),i(K,E),i(K,U),ne&&ne.m(K,null),i(t,O),i(t,P),~R&&re[R].m(P,null),i(t,F),i(t,j),i(j,H),i(j,G),i(j,I),i(j,Y),i(j,X),i(j,Z),i(j,J),Q=!0,V||(ee=[h(y,"click",e[7]),h($,"click",e[8]),h(K,"click",e[6])],V=!0)},p(e,[t]){(!Q||1&t)&&te!==(te=e[5][e[0]]+"")&&g(s,te),(!Q||1&t&&b!==(b="query"==e[0]))&&m(y,"aria-current",b),(!Q||16&t&&k!==(k=null==e[4]))&&(y.disabled=k),(!Q||1&t&&S!==(S="find-stroke"==e[0]))&&m($,"aria-current",S),(!Q||16&t&&T!==(T=null==e[4]))&&($.disabled=T),e[2].new_version&&"unknown"!=e[2].user_knows_about_this_version&&e[2].user_knows_about_this_version!=e[2].new_version?ne||(ne=Ge(),ne.c(),ne.m(K,null)):ne&&(ne.d(1),ne=null),(!Q||1&t&&L!==(L="load-dict"==e[0]))&&m(K,"aria-current",L),(!Q||16&t&&z!==(z=null==e[4]))&&(K.disabled=z);let n=R;R=se(e),R===n?~R&&re[R].p(e,t):(B&&(M(),D(re[n],1,1,()=>{re[n]=null}),N()),~R?(B=re[R],B||(B=re[R]=oe[R](e),B.c()),C(B,1),B.m(P,null)):B=null),(!Q||8&t)&&g(Y,e[3])},i(e){Q||(C(B),Q=!0)},o(e){D(B),Q=!1},d(e){e&&l(t),ne&&ne.d(),~R&&re[R].d(),V=!1,o(ee)}}}function tt(e,t,n){let o="load-dict",r="initializing",s={},i="(unknown)",a=null;const l=Symbol("version_unknown");Z("user-knows-about-this-version").then(e=>{n(2,s.user_knows_about_this_version=e||l,s)}),"serviceWorker"in navigator&&(navigator.serviceWorker.register("serviceworker.js").then(e=>{console.log("Service worker registration successful.")}).catch(e=>{console.log("Service worker registration failed: "+e)}),navigator.serviceWorker.addEventListener("message",e=>{"version-info"==e.data.type?n(3,i=e.data.serviceworker_version):"update-info"==e.data.type?(s.user_knows_about_this_version==l&&(n(2,s.user_knows_about_this_version=e.data.current_version,s),J("user-knows-about-this-version",e.data.current_version)),"up-to-date"==e.data.status?n(2,s.update_available=!1,s):"available"==e.data.status?(n(2,s.update_available=!0,s),n(2,s.new_version=e.data.new_version,s),"load-dict"==o&&"initializing"!=r&&"reading"!=r&&(n(2,s.user_knows_about_this_version=e.data.new_version,s),J("user-knows-about-this-version",e.data.new_version))):"installed"==e.data.status&&(n(2,s.update_available=!1,s),n(2,s.user_knows_about_this_version=e.data.version,s),J("user-knows-about-this-version",e.data.version),window.location.reload()),n(2,s.date_checked=e.data.date_checked,s),n(2,s.update_size=e.data.update_size,s),n(2,s.new_version=e.data.new_version,s),console.log(JSON.stringify(s,null,2))):"serviceworker-info"==e.data.type&&(n(2,s.serviceworker_info=e.data.text,s),console.log(s.serviceworker_info))}),navigator.serviceWorker.controller&&(navigator.serviceWorker.controller.postMessage("get-version"),navigator.serviceWorker.controller.postMessage("get-update-info"),navigator.serviceWorker.controller.postMessage("check-for-updates")));return[o,r,s,i,a,{"load-dict":"Load",query:"Lookup","find-stroke":"Find Stroke"},async function(e){"load-dict"!=o&&(n(0,o="load-dict"),s.new_version&&s.user_knows_about_this_version!=s.new_version&&(n(2,s.user_knows_about_this_version=s.new_version,s),await J("user-knows-about-this-version",s.new_version)))},e=>{n(0,o="query")},e=>{n(0,o="find-stroke")},function(e){a=e,n(4,a)},function(e){s=e,n(2,s)},function(e){r=e,n(1,r)},function(e){o=e,n(0,o)},function(e){a=e,n(4,a)},function(e){a=e,n(4,a)}]}return new class extends I{constructor(e){super(),G(this,e,tt,et,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
