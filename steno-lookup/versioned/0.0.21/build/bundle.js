var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function r(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(e,t){e.appendChild(t)}function l(e,t,n){e.insertBefore(t,n||null)}function a(e){e.parentNode.removeChild(e)}function c(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function u(e){return document.createElement(e)}function d(e){return document.createTextNode(e)}function f(){return d(" ")}function p(){return d("")}function h(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function m(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function g(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function y(e,t){e.value=null==t?"":t}function v(e,t,n){e.classList[n?"add":"remove"](t)}let w;function b(e){w=e}function k(){if(!w)throw new Error("Function called outside component initialization");return w}function _(){const e=k();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);o.slice().forEach(t=>{t.call(e,r)})}}}const $=[],x=[],A=[],S=[],E=Promise.resolve();let T=!1;function K(e){A.push(e)}function q(e){S.push(e)}let W=!1;const U=new Set;function L(){if(!W){W=!0;do{for(let e=0;e<$.length;e+=1){const t=$[e];b(t),z(t.$$)}for(b(null),$.length=0;x.length;)x.pop()();for(let e=0;e<A.length;e+=1){const t=A[e];U.has(t)||(U.add(t),t())}A.length=0}while($.length);for(;S.length;)S.pop()();T=!1,W=!1,U.clear()}}function z(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(K)}}const O=new Set;let P,C;function M(){P={r:0,c:[],p:P}}function N(){P.r||o(P.c),P=P.p}function D(e,t){e&&e.i&&(O.delete(e),e.i(t))}function R(e,t,n,o){if(e&&e.o){if(O.has(e))return;O.add(e),P.c.push(()=>{O.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}function B(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function F(e){e&&e.c()}function j(e,n,s){const{fragment:i,on_mount:l,on_destroy:a,after_update:c}=e.$$;i&&i.m(n,s),K(()=>{const n=l.map(t).filter(r);a?a.push(...n):o(n),e.$$.on_mount=[]}),c.forEach(K)}function H(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Y(e,t){-1===e.$$.dirty[0]&&($.push(e),T||(T=!0,E.then(L)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function G(t,r,s,i,l,c,u=[-1]){const d=w;b(t);const f=r.props||{},p=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:l,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:n(),dirty:u,skip_bound:!1};let h=!1;if(p.ctx=s?s(t,f,(e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&l(p.ctx[e],p.ctx[e]=r)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](r),h&&Y(t,e)),n}):[],p.update(),h=!0,o(p.before_update),p.fragment=!!i&&i(p.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);p.fragment&&p.fragment.l(e),e.forEach(a)}else p.fragment&&p.fragment.c();r.intro&&D(t.$$.fragment),j(t,r.target,r.anchor),L()}b(d)}class I{$destroy(){H(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class X{constructor(e="keyval-store",t="keyval"){this.storeName=t,this._dbp=new Promise((n,o)=>{const r=indexedDB.open(e,1);r.onerror=()=>o(r.error),r.onsuccess=()=>n(r.result),r.onupgradeneeded=()=>{r.result.createObjectStore(t)}})}_withIDBStore(e,t){return this._dbp.then(n=>new Promise((o,r)=>{const s=n.transaction(this.storeName,e);s.oncomplete=()=>o(),s.onabort=s.onerror=()=>r(s.error),t(s.objectStore(this.storeName))}))}}function Z(){return C||(C=new X),C}function J(e,t=Z()){let n;return t._withIDBStore("readonly",t=>{n=t.get(e)}).then(()=>n.result)}function Q(e,t,n=Z()){return n._withIDBStore("readwrite",n=>{n.put(t,e)})}const V=["#","S-","T-","K-","P-","W-","H-","R-","A","O","*","E","U","-F","-R","-P","-B","-L","-G","-T","-S","-D","-Z"],ee={0:"O-",1:"S-",2:"T-",3:"P-",4:"H-",5:"A-",6:"-F",7:"-P",8:"-L",9:"-T"};function te(e){let t=0,n=1;for(const o of V)e.includes(o)&&(t|=n),n<<=1;return t}function ne(e){let t="",n=!0;for(const o of V)1&e&&("-"==o[0]&&n&&(t+="-",n=!1),t+=o.replace("-",""),o.includes("-")||"#"==o||(n=!1)),e>>=1;return t}function oe(e){let t=[];for(let n=0;n<e.length;n+=3){let o=e[n]|e[n+1]<<8|e[n+2]<<16;t.push(ne(o))}return t.join("/")}function re(e){let t=!1,n=0;for(const o of e){if("-"==o){t=!0;continue}let e=V.indexOf(o);if(0==e);else if(e>0)t=!0;else if(e=t?V.indexOf("-"+o):V.indexOf(o+"-"),e<0){const t=ee[o];if(!t){console.log("invalid key!");continue}n|=1,e=V.indexOf(t)}n|=1<<e}return n}function se(e){if(e<0)throw RangeError("File size must be larger than 0!");let t=Math.log10(e)/3;t+=Math.log10(1e3/995)/3,t+=1/3,t=Math.floor(t);const n=Math.round(e/1e3**t*10)/10,o=["","k","M","G","T","P","E"];return t<o.length?n+" "+o[t]+"B":n+"e"+3*t+" B"}let ie,le=new TextDecoder("utf-8"),ae=new TextEncoder("utf-8");async function ce(e){let t="./helpers.wasm";if(ie||(ie=WebAssembly.compileStreaming?WebAssembly.compileStreaming(fetch(t)).catch(e=>{throw`Oh no, there was a problem with loading the WebAssembly module. This is not good, since we can't do anything without that. (${e})`}):fetch(t).catch(e=>{throw`Couldn't load the wasm file for some reason. Sorry, this shouldn't happen. (${e})`}).then(e=>e.arrayBuffer()).then(e=>WebAssembly.compile(e)).catch(e=>{throw e instanceof TypeError?`Sorry, it seems like your browser does not support WebAssembly. We need this to make your queries fast while using as little of your precious RAM as possible. WebAssembly should be supported in the newest versions of all major browsers, except for Internet Explorer. (${e})`:e})),e){return de(await ue(ie),e)}}async function ue(e){let t,n,o=[];let r=await WebAssembly.instantiate(await e,{env:{logErr:function(e,o,r,s,i){if(t){const l=new Uint8Array(t.buffer,e,o),a=new Uint8Array(t.buffer,r,s),c=le.decode(l),u=le.decode(a);console.log(`WebAssembly module panicked with '${c} (${u})' on line ${i}`),n={message:c,details:u}}else console.log("Warning: logErr got called, but memory was not initialized??")},yield_result:function(e,n,r,s){let i=le.decode(new Uint8Array(t.buffer,e,n)),l=new Uint8Array(t.buffer,r,s);o.push([oe(l),i])}}});return t=r.exports.memory,{instance:r,results:o,get_last_error:function(){return n}}}function de(e,t){let n=t.length;const o=n+100,r=Math.ceil(o/65536);let s=e.instance,i=e.results;const l=65536*s.exports.memory.grow(r),a=l+n;let c=new Uint8Array(s.exports.memory.buffer,l,n);c.set(t);let u=l;return{lookup:function(t){const n=performance.now(),o=ae.encode(t).subarray(0,100);new Uint8Array(s.exports.memory.buffer,a,o.length).set(o),i.splice(0,i.length);try{s.exports.query(a,o.length,u,0)}catch(t){let n=e.get_last_error();throw n||`Error in WebAssembly module: ${t} (this probably shouldn't have happened)`}return console.log(`query took ${performance.now()-n}ms`),i.slice()},find_strokes:function(t){const n=performance.now(),o=t.subarray(0,100);new Uint8Array(s.exports.memory.buffer,a,o.length).set(o),i.splice(0,i.length);try{s.exports.query(a,o.length,u,1)}catch(t){let n=e.get_last_error();throw n||`Error in WebAssembly module: ${t} (this probably shouldn't have happened)`}return console.log(`query took ${performance.now()-n}ms`),i.slice()},data:c}}function fe(e){let t,n,o,r,s,c,p,y,v=e[0].name+"";return{c(){t=u("div"),n=u("p"),o=d("Current file: "),r=d(v),s=f(),c=u("button"),c.textContent="Remove",m(n,"class","svelte-uaenwa"),m(c,"class","svelte-uaenwa"),m(t,"id","loaded"),m(t,"class","svelte-uaenwa")},m(a,u){l(a,t,u),i(t,n),i(n,o),i(n,r),i(t,s),i(t,c),p||(y=h(c,"click",e[6]),p=!0)},p(e,t){1&t&&v!==(v=e[0].name+"")&&g(r,v)},d(e){e&&a(t),p=!1,y()}}}function pe(e){let t,n,o,r,s;function i(e,t){return"choosefile"==e[1]?me:"error"==e[1]||"reading"==e[1]?he:void 0}let c=i(e),d=c&&c(e);return{c(){t=u("input"),n=f(),d&&d.c(),o=p(),m(t,"type","file"),m(t,"class","svelte-uaenwa")},m(i,a){l(i,t,a),l(i,n,a),d&&d.m(i,a),l(i,o,a),r||(s=h(t,"change",e[9]),r=!0)},p(e,t){c===(c=i(e))&&d?d.p(e,t):(d&&d.d(1),d=c&&c(e),d&&(d.c(),d.m(o.parentNode,o)))},d(e){e&&a(t),e&&a(n),d&&d.d(e),e&&a(o),r=!1,s()}}}function he(e){let t,n,o,r,s=e[4]&&ge(e);return{c(){t=u("p"),n=d(e[3]),o=f(),s&&s.c(),r=p(),m(t,"class","svelte-uaenwa")},m(e,a){l(e,t,a),i(t,n),l(e,o,a),s&&s.m(e,a),l(e,r,a)},p(e,t){8&t&&g(n,e[3]),e[4]?s?s.p(e,t):(s=ge(e),s.c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d(e){e&&a(t),e&&a(o),s&&s.d(e),e&&a(r)}}}function me(t){let n,o,r;return{c(){n=u("p"),n.textContent="Please choose a dictionary from your device.",o=f(),r=u("p"),r.textContent="The dictionary will be stored inside of your browser, so you can access it when you load this page the next time. It will stay on your device only, and will not be sent anywhere else.",m(n,"class","svelte-uaenwa"),m(r,"id","smallstatus"),m(r,"class","svelte-uaenwa")},m(e,t){l(e,n,t),l(e,o,t),l(e,r,t)},p:e,d(e){e&&a(n),e&&a(o),e&&a(r)}}}function ge(e){let t,n;return{c(){t=u("p"),n=d(e[4]),m(t,"id","smallstatus"),m(t,"class","svelte-uaenwa")},m(e,o){l(e,t,o),i(t,n)},p(e,t){16&t&&g(n,e[4])},d(e){e&&a(t)}}}function ye(e){let t,n,o,r,s,c,p,y=(e[2].date_checked?e[7].format(e[2].date_checked):"(unknown)")+"";return{c(){t=u("p"),n=d("Last checked: "),o=d(y),r=f(),s=u("button"),s.textContent="Check",m(t,"class","svelte-uaenwa"),m(s,"class","svelte-uaenwa")},m(a,u){l(a,t,u),i(t,n),i(t,o),l(a,r,u),l(a,s,u),c||(p=h(s,"click",e[11]),c=!0)},p(e,t){4&t&&y!==(y=(e[2].date_checked?e[7].format(e[2].date_checked):"(unknown)")+"")&&g(o,y)},d(e){e&&a(t),e&&a(r),e&&a(s),c=!1,p()}}}function ve(e){let t,n,o,r,s,c,p,y,v=se(e[2].update_size)+"";return{c(){t=u("p"),n=d("Update available ("),o=d(v),r=d(")"),s=f(),c=u("button"),c.textContent="Update!",m(t,"class","svelte-uaenwa"),m(c,"class","svelte-uaenwa")},m(a,u){l(a,t,u),i(t,n),i(t,o),i(t,r),l(a,s,u),l(a,c,u),p||(y=h(c,"click",e[10]),p=!0)},p(e,t){4&t&&v!==(v=se(e[2].update_size)+"")&&g(o,v)},d(e){e&&a(t),e&&a(s),e&&a(c),p=!1,y()}}}function we(e){let t,n,o=e[2].serviceworker_info+"";return{c(){t=u("p"),n=d(o),m(t,"id","update-info"),m(t,"class","svelte-uaenwa")},m(e,o){l(e,t,o),i(t,n)},p(e,t){4&t&&o!==(o=e[2].serviceworker_info+"")&&g(n,o)},d(e){e&&a(t)}}}function be(t){let n,o,r,s,i,c;function d(e,t){return null===e[0]?pe:fe}let h=d(t),g=h(t);function y(e,t){return e[2].update_available?ve:ye}let v=y(t),w=v(t),b=t[2].serviceworker_info&&we(t);return{c(){g.c(),n=f(),o=u("h2"),o.textContent="Updates",r=f(),s=u("div"),w.c(),i=f(),b&&b.c(),c=p(),m(o,"class","svelte-uaenwa"),m(s,"id","updates"),m(s,"class","svelte-uaenwa")},m(e,t){g.m(e,t),l(e,n,t),l(e,o,t),l(e,r,t),l(e,s,t),w.m(s,null),l(e,i,t),b&&b.m(e,t),l(e,c,t)},p(e,[t]){h===(h=d(e))&&g?g.p(e,t):(g.d(1),g=h(e),g&&(g.c(),g.m(n.parentNode,n))),v===(v=y(e))&&w?w.p(e,t):(w.d(1),w=v(e),w&&(w.c(),w.m(s,null))),e[2].serviceworker_info?b?b.p(e,t):(b=we(e),b.c(),b.m(c.parentNode,c)):b&&(b.d(1),b=null)},i:e,o:e,d(e){g.d(e),e&&a(n),e&&a(o),e&&a(r),e&&a(s),w.d(),e&&a(i),b&&b.d(e),e&&a(c)}}}function ke(e,t,n){let{dictionary:o}=t,{status:r}=t,{app_status:s}=t,{update_info:i}=t,l="",a="",c=[];var u;async function d(e){n(3,l="Organizing data..."),n(4,a="");try{n(0,o=await async function(e){ce();const t=await ue(ie),n=t.instance,o=ae.encode(e),r=Math.ceil(o.length/65536),s=n.exports.memory.grow(r),i=65536*s;console.log("number of base pages: "+s),new Uint8Array(n.exports.memory.buffer).subarray(i,i+o.length).set(o),console.log("before wasm");const l=performance.now();let a;try{a=n.exports.load_json(i,o.length)}catch(e){let n=t.get_last_error();throw n||`Error in WebAssembly module: ${e} (this probably shouldn't have happened)`}console.log(`after wasm (took ${performance.now()-l}ms)`);const c=new Uint32Array(n.exports.memory.buffer,a,3),u=12+4*c[1]+c[2];console.log("data length: "+u);const d=new Uint8Array(n.exports.memory.buffer,a,u).slice();return de(await ue(ie),d)}(e.result))}catch(e){return console.log(e),n(1,r="error"),e.message||(e={message:"An error occured while trying to load your dictionary.",details:""+e}),n(3,l=e.message),void n(4,a=e.details)}n(0,o.name=c[0].name,o),await Q("dictionary",{name:o.name,data:o.data}),n(1,r="loaded"),n(8,s="query"),n(3,l=""),n(4,a="")}u=async()=>{if("initializing"==r){let e=await J("dictionary");if(e){try{n(0,o=await ce(e.data))}catch(e){return n(1,r="error"),n(3,l="Error occured while trying to load stored dictionary."),void n(4,a=""+e)}n(0,o.name=e.name,o),n(1,r="loaded"),n(8,s="query")}else n(1,r="choosefile")}},k().$$.on_mount.push(u);const f=new Intl.DateTimeFormat(void 0,{month:"long",day:"numeric",hour:"numeric",minute:"numeric"});return e.$$set=e=>{"dictionary"in e&&n(0,o=e.dictionary),"status"in e&&n(1,r=e.status),"app_status"in e&&n(8,s=e.app_status),"update_info"in e&&n(2,i=e.update_info)},e.$$.update=()=>{32&e.$$.dirty&&function(e){if(e.length>0){let t=e[0];if(t.size>10485760)n(1,r="error"),n(3,l="Sorry, we only accept files up to 10MB currently."),n(4,a="");else if("application/json"!=t.type)n(1,r="error"),n(3,l="Sorry, right now we can only read plover json dictionaries."),n(4,a="");else{n(1,r="reading"),n(3,l="Loading... 0%"),n(4,a="");let e=new FileReader;e.addEventListener("load",t=>d(e)),e.addEventListener("progress",e=>{let t=Math.floor(e.loaded/e.total*100);n(3,l=`Loading... ${t}%`)}),e.addEventListener("abort",e=>{n(1,r="error"),n(3,l="Aborted."),n(4,a="")}),e.addEventListener("error",e=>{n(1,r="error"),n(3,l="Your browser failed to load the file. Please try again."),n(4,a="")}),e.readAsText(t)}}}(c)},[o,r,i,l,a,c,async function(e){n(0,o=null),await function(e,t=Z()){return t._withIDBStore("readwrite",t=>{t.delete(e)})}("dictionary"),n(1,r="choosefile")},f,s,function(){c=this.files,n(5,c)},e=>navigator.serviceWorker.controller.postMessage("do-update"),e=>navigator.serviceWorker.controller.postMessage("check-for-updates")]}class _e extends I{constructor(e){super(),G(this,e,ke,be,s,{dictionary:0,status:1,app_status:8,update_info:2})}}function $e(e,t,n){const o=e.slice();return o[1]=t[n][0],o[2]=t[n][1],o}function xe(e){let t,n=e[0],o=[];for(let t=0;t<n.length;t+=1)o[t]=Se($e(e,n,t));return{c(){t=u("table");for(let e=0;e<o.length;e+=1)o[e].c();m(t,"class","svelte-1tqx9ii")},m(e,n){l(e,t,n);for(let e=0;e<o.length;e+=1)o[e].m(t,null)},p(e,r){if(1&r){let s;for(n=e[0],s=0;s<n.length;s+=1){const i=$e(e,n,s);o[s]?o[s].p(i,r):(o[s]=Se(i),o[s].c(),o[s].m(t,null))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(e){e&&a(t),c(o,e)}}}function Ae(t){let n;return{c(){n=u("p"),n.textContent="(no results)",m(n,"class","svelte-1tqx9ii")},m(e,t){l(e,n,t)},p:e,d(e){e&&a(n)}}}function Se(e){let t,n,o,r,s,c=e[1]+"",f=e[2]+"";return{c(){t=u("tr"),n=u("td"),o=d(c),r=u("td"),s=d(f),m(n,"class","strokes svelte-1tqx9ii"),m(r,"class","svelte-1tqx9ii"),m(t,"class","svelte-1tqx9ii")},m(e,a){l(e,t,a),i(t,n),i(n,o),i(t,r),i(r,s)},p(e,t){1&t&&c!==(c=e[1]+"")&&g(o,c),1&t&&f!==(f=e[2]+"")&&g(s,f)},d(e){e&&a(t)}}}function Ee(t){let n;function o(e,t){return 0==e[0].length?Ae:xe}let r=o(t),s=r(t);return{c(){s.c(),n=p()},m(e,t){s.m(e,t),l(e,n,t)},p(e,[t]){r===(r=o(e))&&s?s.p(e,t):(s.d(1),s=r(e),s&&(s.c(),s.m(n.parentNode,n)))},i:e,o:e,d(e){s.d(e),e&&a(n)}}}function Te(e,t,n){let{results:o=[]}=t;return e.$$set=e=>{"results"in e&&n(0,o=e.results)},[o]}class Ke extends I{constructor(e){super(),G(this,e,Te,Ee,s,{results:0})}}function qe(t){let n,o,r,s,c=t[2].message+"",h=t[2].details&&Ue(t);return{c(){n=u("p"),o=d(c),r=f(),h&&h.c(),s=p(),m(n,"id","bigerror"),m(n,"class","svelte-asd7nl")},m(e,t){l(e,n,t),i(n,o),l(e,r,t),h&&h.m(e,t),l(e,s,t)},p(e,t){4&t&&c!==(c=e[2].message+"")&&g(o,c),e[2].details?h?h.p(e,t):(h=Ue(e),h.c(),h.m(s.parentNode,s)):h&&(h.d(1),h=null)},i:e,o:e,d(e){e&&a(n),e&&a(r),h&&h.d(e),e&&a(s)}}}function We(e){let t,n;return t=new Ke({props:{results:e[1]}}),{c(){F(t.$$.fragment)},m(e,o){j(t,e,o),n=!0},p(e,n){const o={};2&n&&(o.results=e[1]),t.$set(o)},i(e){n||(D(t.$$.fragment,e),n=!0)},o(e){R(t.$$.fragment,e),n=!1},d(e){H(t,e)}}}function Ue(e){let t,n,o=e[2].details+"";return{c(){t=u("p"),n=d(o),m(t,"id","smallerror"),m(t,"class","svelte-asd7nl")},m(e,o){l(e,t,o),i(t,n)},p(e,t){4&t&&o!==(o=e[2].details+"")&&g(n,o)},d(e){e&&a(t)}}}function Le(e){let t,n,o,r,s,i,c,d;const g=[We,qe],v=[];function w(e,t){return void 0!==e[1]?0:e[2]?1:-1}return~(o=w(e))&&(r=v[o]=g[o](e)),{c(){t=u("input"),n=f(),r&&r.c(),s=p(),m(t,"id","query-input"),m(t,"type","text"),m(t,"aria-labelledby","mode-label"),m(t,"class","svelte-asd7nl")},m(r,a){l(r,t,a),y(t,e[0]),l(r,n,a),~o&&v[o].m(r,a),l(r,s,a),i=!0,c||(d=h(t,"input",e[4]),c=!0)},p(e,[n]){1&n&&t.value!==e[0]&&y(t,e[0]);let i=o;o=w(e),o===i?~o&&v[o].p(e,n):(r&&(M(),R(v[i],1,1,()=>{v[i]=null}),N()),~o?(r=v[o],r||(r=v[o]=g[o](e),r.c()),D(r,1),r.m(s.parentNode,s)):r=null)},i(e){i||(D(r),i=!0)},o(e){R(r),i=!1},d(e){e&&a(t),e&&a(n),~o&&v[o].d(e),e&&a(s),c=!1,d()}}}function ze(e,t,n){let o,{dictionary:r}=t,s="",i=[];return e.$$set=e=>{"dictionary"in e&&n(3,r=e.dictionary)},e.$$.update=()=>{1&e.$$.dirty&&function(e){n(2,o=void 0),n(1,i=void 0);try{n(1,i=r.lookup(e)),console.log("asdf "+i)}catch(e){n(1,i=void 0),e.message?n(2,o=e):n(2,o={message:e.toString()})}}(s)},[s,i,o,r,function(){s=this.value,n(0,s)}]}class Oe extends I{constructor(e){super(),G(this,e,ze,Le,s,{dictionary:3})}}function Pe(e,t,n){const o=e.slice();return o[27]=t[n],o[28]=t,o[29]=n,o}function Ce(e){let t,n,r,s,i,c,d,f=e[27];const p=()=>e[18](t,f),g=()=>e[18](null,f);return{c(){t=u("button"),m(t,"id",n=e[6][e[27]]||e[27]),m(t,"aria-label",r=e[7][e[27]]),m(t,"aria-pressed",s=!!e[4][e[27]]),m(t,"tabindex",i=e[8][e[2][0]][e[2][1]]==e[27]?0:-1),m(t,"class","steno svelte-1qg3yy1"),v(t,"long-key","S-"==e[27]||"*"==e[27]),v(t,"top-row",1==e[0][e[27]][0]),v(t,"bottom-row",2==e[0][e[27]][0]),v(t,"left-vowel","A"==e[27]||"O"==e[27]),v(t,"right-vowel","E"==e[27]||"U"==e[27])},m(n,o){var r;l(n,t,o),p(),c||(d=[h(t,"click",e[12]),h(t,"touchstart",(r=e[9],function(e){return e.preventDefault(),r.call(this,e)})),h(t,"touchmove",e[10]),h(t,"touchend",e[11]),h(t,"touchcancel",e[11]),h(t,"keydown",e[13]),h(t,"keyup",e[14]),h(t,"focus",e[15])],c=!0)},p(n,o){e=n,16&o&&s!==(s=!!e[4][e[27]])&&m(t,"aria-pressed",s),4&o&&i!==(i=e[8][e[2][0]][e[2][1]]==e[27]?0:-1)&&m(t,"tabindex",i),f!==e[27]&&(g(),f=e[27],p()),32&o&&v(t,"long-key","S-"==e[27]||"*"==e[27]),33&o&&v(t,"top-row",1==e[0][e[27]][0]),33&o&&v(t,"bottom-row",2==e[0][e[27]][0]),32&o&&v(t,"left-vowel","A"==e[27]||"O"==e[27]),32&o&&v(t,"right-vowel","E"==e[27]||"U"==e[27])},d(e){e&&a(t),g(),c=!1,o(d)}}}function Me(t){let n,o,r,s,d,p,g,y,v,w,b,k,_,$,x,A,S,E=t[5],T=[];for(let e=0;e<E.length;e+=1)T[e]=Ce(Pe(t,E,e));return{c(){n=u("button"),o=u("img"),s=f(),d=u("span"),d.textContent="virtual stenotype help",p=f(),g=u("div"),y=u("p"),y.innerHTML="<b>Mouse:</b> Click keys to toggle them.",v=f(),w=u("p"),w.innerHTML="<b>Touch:</b> Touch or swipe over keys to toggle them.",b=f(),k=u("p"),k.innerHTML="<b>Keyboard</b>: Use the arrow keys to move focus in between buttons on the virtual stenotype, and space or return to toggle. To move focus back out of the stenotype, just use tab or shift-tab once. <em>Experimental:</em> You may use a qwerty keyboard as direct input to the stenotype (while one of its keys is focused). Your left hand&#39;s homerow is between Q–R and A–F; your right hand&#39;s is between U–P and J–semicolon. Your left thumb sits on C and V, and your right thumb on N and M. Pressing a key will add the corresponding letter to the chord, but will never remove it; to clear the chord, use backspace.",$=f(),x=u("div");for(let e=0;e<T.length;e+=1)T[e].c();o.src!==(r=t[3]?"collapse-icon.svg":"expand-icon.svg")&&m(o,"src",r),m(o,"alt",""),m(o,"class","svelte-1qg3yy1"),m(d,"class","svelte-1qg3yy1"),m(n,"class","keyboard-help-toggle svelte-1qg3yy1"),m(n,"aria-expanded",t[3]),m(y,"class","steno-keyboard-hint svelte-1qg3yy1"),m(w,"class","steno-keyboard-hint svelte-1qg3yy1"),m(k,"class","steno-keyboard-hint svelte-1qg3yy1"),m(g,"id","steno-keyboard-hint-container"),g.hidden=_=!t[3],m(g,"class","svelte-1qg3yy1"),m(x,"id","steno-keyboard"),m(x,"role","group"),m(x,"aria-label","steno keyboard"),m(x,"class","svelte-1qg3yy1")},m(e,r){l(e,n,r),i(n,o),i(n,s),i(n,d),l(e,p,r),l(e,g,r),i(g,y),i(g,v),i(g,w),i(g,b),i(g,k),l(e,$,r),l(e,x,r);for(let e=0;e<T.length;e+=1)T[e].m(x,null);A||(S=h(n,"click",t[17]),A=!0)},p(e,[t]){if(8&t&&o.src!==(r=e[3]?"collapse-icon.svg":"expand-icon.svg")&&m(o,"src",r),8&t&&m(n,"aria-expanded",e[3]),8&t&&_!==(_=!e[3])&&(g.hidden=_),65527&t){let n;for(E=e[5],n=0;n<E.length;n+=1){const o=Pe(e,E,n);T[n]?T[n].p(o,t):(T[n]=Ce(o),T[n].c(),T[n].m(x,null))}for(;n<T.length;n+=1)T[n].d(1);T.length=E.length}},i:e,o:e,d(e){e&&a(n),e&&a(p),e&&a(g),e&&a($),e&&a(x),c(T,e),A=!1,S()}}}function Ne(e,t,n){const o=["#","S-","T-","K-","P-","W-","H-","R-","A","O","*","E","U","-F","-R","-P","-B","-L","-G","-T","-S","-D","-Z"],r={number:"#",star:"*"},s=[["#","#","#","#","#","#","#","#","#","#"],["S-","T-","P-","H-","*","-F","-P","-L","-T","-D"],["S-","K-","W-","R-","*","-R","-B","-G","-S","-Z"],[null,null,"A","O",null,"E","U",null,null,null]];let i={};for(let e=0;e<s.length;e++){let t=s[e];for(let n=0;n<t.length;n++){let o=t[n];o&&!i[o]&&(i[o]=[e,n])}}let l={KeyQ:"S-",KeyA:"S-",KeyW:"T-",KeyS:"K-",KeyE:"P-",KeyD:"W-",KeyR:"H-",KeyF:"R-",KeyC:"A",KeyV:"O",KeyT:"*",KeyG:"*",KeyY:"*",KeyH:"*",KeyN:"E",KeyM:"U",KeyU:"-F",KeyJ:"-R",KeyI:"-P",KeyK:"-B",KeyO:"-L",KeyL:"-G",KeyP:"-T",Semicolon:"-S",BracketLeft:"-D",Quote:"-Z"};const a={};let c=[0,0],u=!1,d={};for(const e of o)d[e]=!1;let{strokes:f=[0]}=t;const p=_();function h(){p("strokeChanged",{stroke:te(Object.entries(d).filter(([e,t])=>t).map(([e,t])=>e))})}let m={},g=null;function y(e){let t=[c[0]+e[0],c[1]+e[1]];if(t[0]>=0&&t[0]<s.length){let o=s[c[0]][c[1]],r=s[t[0]][t[1]];r&&r!=o||(console.log("double move"),t=[t[0]+e[0],t[1]+e[1]],t[0]>=0&&t[0]<s.length&&(r=s[t[0]][t[1]])),r&&r!=o&&(a[r].focus(),n(2,c=t),console.log(c))}}return e.$$set=e=>{"strokes"in e&&n(16,f=e.strokes)},e.$$.update=()=>{65536&e.$$.dirty&&n(4,d=function(e){let t={};for(const n of V)t[n]=1&e,e>>=1;return t}(f[f.length-1]))},[i,a,c,u,d,o,{"#":"number","*":"star"},{"#":"number bar","S-":"left S","T-":"left T","K-":"left K","P-":"left P","W-":"left W","H-":"left H","R-":"left R",A:"A",O:"O","*":"asterisk",E:"E",U:"U","-F":"right F","-R":"right R","-P":"right P","-B":"right B","-L":"right L","-G":"right G","-T":"right T","-S":"right S","-D":"right D","-Z":"right Z"},s,function(e){e.touches;for(let t=0;t<e.touches.length;t++){let o=e.touches[t];if(!m.hasOwnProperty(o.identifier)){let t=r[e.target.id]||e.target.id;n(4,d[t]^=!0,d);let s=d[t];console.log("new touch with mode "+s),m[o.identifier]={x:o.clientX,y:o.clientY,mode:s}}}h()},function(e){let t=e.changedTouches,o=!1;for(let e=0;e<t.length;e++){let s=t[e],i=m[s.identifier];if(!i)continue;let l=window.innerWidth/20,a=s.clientX-i.x,c=s.clientY-i.y,u=Math.sqrt(a**2+c**2),f=a/u*l,p=c/u*l;for(;u>0;){let e=i.x+a,t=i.y+c;u-=l,a-=f,c-=p;let s=document.elementFromPoint(e,t),h=r[s.id]||s.id;d.hasOwnProperty(h)&&d[h]!=i.mode&&(n(4,d[h]=i.mode,d),o=!0)}i.x=s.clientX,i.y=s.clientY}o&&h()},function(e){let t=e.changedTouches;for(let e=0;e<t.length;e++)delete m[t[e].identifier];g={x:t[t.length-1].clientX,y:t[t.length-1].clientY,target:t[t.length-1].target},console.log(g)},function(e){if(console.log(`x: ${e.clientX}, y: ${e.clientY}`),null!==g){if(e.target==g.target&&g.x==e.clientX&&g.y==e.clientY)return void(g=null);g=null}const t=r[e.target.id]||e.target.id;n(4,d[t]^=!0,d),h()},function(e){switch(e.key){case"Down":case"ArrowDown":y([1,0]),e.preventDefault();break;case"Up":case"ArrowUp":y([-1,0]),e.preventDefault();break;case"Left":case"ArrowLeft":y([0,-1]);break;case"Right":case"ArrowRight":y([0,1]);break;case"Backspace":for(const e of o)n(4,d[e]=0,d);break;default:let t=l[e.code];t&&(n(4,d[t]=1,d),h())}},function(e){l[e.code]&&h()},function(e){let t=r[e.target.id]||e.target.id;n(2,c=i[t]),console.log("changed focus to "+c)},f,e=>{n(3,u=!u)},function(e,t){x[e?"unshift":"push"](()=>{a[t]=e,n(1,a),n(5,o)})}]}class De extends I{constructor(e){super(),G(this,e,Ne,Me,s,{strokes:16})}}function Re(t){let n,o,r,s,c=t[3].message+"",h=t[3].details&&Fe(t);return{c(){n=u("p"),o=d(c),r=f(),h&&h.c(),s=p(),m(n,"id","bigerror")},m(e,t){l(e,n,t),i(n,o),l(e,r,t),h&&h.m(e,t),l(e,s,t)},p(e,t){8&t&&c!==(c=e[3].message+"")&&g(o,c),e[3].details?h?h.p(e,t):(h=Fe(e),h.c(),h.m(s.parentNode,s)):h&&(h.d(1),h=null)},i:e,o:e,d(e){e&&a(n),e&&a(r),h&&h.d(e),e&&a(s)}}}function Be(e){let t,n;return t=new Ke({props:{results:e[2]}}),{c(){F(t.$$.fragment)},m(e,o){j(t,e,o),n=!0},p(e,n){const o={};4&n&&(o.results=e[2]),t.$set(o)},i(e){n||(D(t.$$.fragment,e),n=!0)},o(e){R(t.$$.fragment,e),n=!1},d(e){H(t,e)}}}function Fe(e){let t,n,o=e[3].details+"";return{c(){t=u("p"),n=d(o),m(t,"id","smallerror"),m(t,"class","svelte-y68lui")},m(e,o){l(e,t,o),i(t,n)},p(e,t){8&t&&o!==(o=e[3].details+"")&&g(n,o)},d(e){e&&a(t)}}}function je(e){let t,n,o,r,s,i,c,d,g,y,v;function w(t){e[7].call(null,t)}let b={};void 0!==e[0]&&(b.strokes=e[0]),t=new De({props:b}),x.push(()=>B(t,"strokes",w)),t.$on("strokeChanged",e[5]);const k=[Be,Re],_=[];function $(e,t){return void 0!==e[2]?0:e[3]?1:-1}return~(i=$(e))&&(c=_[i]=k[i](e)),{c(){F(t.$$.fragment),o=f(),r=u("input"),s=f(),c&&c.c(),d=p(),m(r,"type","text"),m(r,"aria-labelledby","mode-label"),m(r,"class","svelte-y68lui")},m(n,a){j(t,n,a),l(n,o,a),l(n,r,a),e[8](r),l(n,s,a),~i&&_[i].m(n,a),l(n,d,a),g=!0,y||(v=h(r,"input",e[4]),y=!0)},p(e,[o]){const r={};!n&&1&o&&(n=!0,r.strokes=e[0],q(()=>n=!1)),t.$set(r);let s=i;i=$(e),i===s?~i&&_[i].p(e,o):(c&&(M(),R(_[s],1,1,()=>{_[s]=null}),N()),~i?(c=_[i],c||(c=_[i]=k[i](e),c.c()),D(c,1),c.m(d.parentNode,d)):c=null)},i(e){g||(D(t.$$.fragment,e),D(c),g=!0)},o(e){R(t.$$.fragment,e),R(c),g=!1},d(n){H(t,n),n&&a(o),n&&a(r),e[8](null),n&&a(s),~i&&_[i].d(n),n&&a(d),y=!1,v()}}}function He(e,t,n){let o,r,{dictionary:s}=t,i=[0],l="",a=[];async function c(){n(3,r=void 0),n(2,a=void 0);try{n(2,a=s.find_strokes(function(e){let t=[];for(const n of e)t.push(255&n),t.push(n>>8&255),t.push(n>>16&255);return new Uint8Array(t)}(i)))}catch(e){n(2,a=void 0),e.message?n(3,r=e):n(3,r={message:e.toString()})}}return e.$$set=e=>{"dictionary"in e&&n(6,s=e.dictionary)},[i,o,a,r,function(e){const t=e.target.value;t!=l&&(l=t,n(0,i=l.toUpperCase().split("/").map(re)),c())},function(e){n(0,i[i.length-1]=e.detail.stroke,i),l=i.map(ne).join("/"),n(1,o.value=l,o),c()},s,function(e){i=e,n(0,i)},function(e){x[e?"unshift":"push"](()=>{o=e,n(1,o)})}]}class Ye extends I{constructor(e){super(),G(this,e,He,je,s,{dictionary:6})}}function Ge(e){let t;return{c(){t=u("div"),m(t,"id","notification-marker"),m(t,"class","svelte-zn3s74")},m(e,n){l(e,t,n)},d(e){e&&a(t)}}}function Ie(e){let t,n,o,r;const s=[Qe,Je],i=[];function c(e,t){return null===e[4]?0:1}return t=c(e),n=i[t]=s[t](e),{c(){n.c(),o=p()},m(e,n){i[t].m(e,n),l(e,o,n),r=!0},p(e,r){let l=t;t=c(e),t===l?i[t].p(e,r):(M(),R(i[l],1,1,()=>{i[l]=null}),N(),n=i[t],n||(n=i[t]=s[t](e),n.c()),D(n,1),n.m(o.parentNode,o))},i(e){r||(D(n),r=!0)},o(e){R(n),r=!1},d(e){i[t].d(e),e&&a(o)}}}function Xe(e){let t,n,o,r;const s=[et,Ve],i=[];function c(e,t){return null===e[4]?0:1}return t=c(e),n=i[t]=s[t](e),{c(){n.c(),o=p()},m(e,n){i[t].m(e,n),l(e,o,n),r=!0},p(e,r){let l=t;t=c(e),t===l?i[t].p(e,r):(M(),R(i[l],1,1,()=>{i[l]=null}),N(),n=i[t],n||(n=i[t]=s[t](e),n.c()),D(n,1),n.m(o.parentNode,o))},i(e){r||(D(n),r=!0)},o(e){R(n),r=!1},d(e){i[t].d(e),e&&a(o)}}}function Ze(e){let t,n,o,r,s,i;function l(t){e[9].call(null,t)}function a(t){e[10].call(null,t)}function c(t){e[11].call(null,t)}function u(t){e[12].call(null,t)}let d={};return void 0!==e[4]&&(d.dictionary=e[4]),void 0!==e[2]&&(d.update_info=e[2]),void 0!==e[1]&&(d.status=e[1]),void 0!==e[0]&&(d.app_status=e[0]),t=new _e({props:d}),x.push(()=>B(t,"dictionary",l)),x.push(()=>B(t,"update_info",a)),x.push(()=>B(t,"status",c)),x.push(()=>B(t,"app_status",u)),{c(){F(t.$$.fragment)},m(e,n){j(t,e,n),i=!0},p(e,i){const l={};!n&&16&i&&(n=!0,l.dictionary=e[4],q(()=>n=!1)),!o&&4&i&&(o=!0,l.update_info=e[2],q(()=>o=!1)),!r&&2&i&&(r=!0,l.status=e[1],q(()=>r=!1)),!s&&1&i&&(s=!0,l.app_status=e[0],q(()=>s=!1)),t.$set(l)},i(e){i||(D(t.$$.fragment,e),i=!0)},o(e){R(t.$$.fragment,e),i=!1},d(e){H(t,e)}}}function Je(e){let t,n,o;function r(t){e[14].call(null,t)}let s={};return void 0!==e[4]&&(s.dictionary=e[4]),t=new Ye({props:s}),x.push(()=>B(t,"dictionary",r)),{c(){F(t.$$.fragment)},m(e,n){j(t,e,n),o=!0},p(e,o){const r={};!n&&16&o&&(n=!0,r.dictionary=e[4],q(()=>n=!1)),t.$set(r)},i(e){o||(D(t.$$.fragment,e),o=!0)},o(e){R(t.$$.fragment,e),o=!1},d(e){H(t,e)}}}function Qe(t){let n,o;return{c(){n=d("// TODO: un-duplicate this code\n        "),o=u("p"),o.textContent="No dictionary loaded.",m(o,"id","nodict"),m(o,"class","svelte-zn3s74")},m(e,t){l(e,n,t),l(e,o,t)},p:e,i:e,o:e,d(e){e&&a(n),e&&a(o)}}}function Ve(e){let t,n,o;function r(t){e[13].call(null,t)}let s={};return void 0!==e[4]&&(s.dictionary=e[4]),t=new Oe({props:s}),x.push(()=>B(t,"dictionary",r)),{c(){F(t.$$.fragment)},m(e,n){j(t,e,n),o=!0},p(e,o){const r={};!n&&16&o&&(n=!0,r.dictionary=e[4],q(()=>n=!1)),t.$set(r)},i(e){o||(D(t.$$.fragment,e),o=!0)},o(e){R(t.$$.fragment,e),o=!1},d(e){H(t,e)}}}function et(t){let n;return{c(){n=u("p"),n.textContent="No dictionary loaded.",m(n,"id","nodict"),m(n,"class","svelte-zn3s74")},m(e,t){l(e,n,t)},p:e,i:e,o:e,d(e){e&&a(n)}}}function tt(e){let t,n,r,s,c,p,y,v,w,b,k,_,$,x,A,S,E,T,K,q,W,U,L,z,O,P,C,B,F,j,H,Y,G,I,X,Z,J,Q,V,ee,te=e[5][e[0]]+"",ne=e[2].new_version&&"unknown"!=e[2].user_knows_about_this_version&&e[2].user_knows_about_this_version!=e[2].new_version&&Ge();const oe=[Ze,Xe,Ie],re=[];function se(e,t){return"load-dict"==e[0]?0:"query"==e[0]?1:"find-stroke"==e[0]?2:-1}return~(C=se(e))&&(B=re[C]=oe[C](e)),{c(){t=u("div"),n=u("header"),r=u("h1"),s=d(te),c=f(),p=u("nav"),y=u("button"),v=u("img"),_=f(),$=u("button"),x=u("img"),T=f(),K=u("button"),q=u("img"),U=f(),ne&&ne.c(),O=f(),P=u("main"),B&&B.c(),F=f(),j=u("p"),H=d("App version: 0.0.21"),Y=u("br"),G=d("Updater version: "),I=d(e[3]),X=u("br"),Z=d("File a bug or contribute to development on "),J=u("a"),J.textContent="github",m(r,"id","mode-label"),m(r,"aria-live","polite"),m(r,"class","svelte-zn3s74"),v.src!==(w="abc-icon.svg")&&m(v,"src","abc-icon.svg"),m(v,"alt","lookup"),m(v,"class","svelte-zn3s74"),m(y,"aria-current",b="query"==e[0]),y.disabled=k=null==e[4],m(y,"class","svelte-zn3s74"),x.src!==(A="STK-icon.svg")&&m(x,"src","STK-icon.svg"),m(x,"alt","find stroke"),m(x,"class","svelte-zn3s74"),m($,"aria-current",S="find-stroke"==e[0]),$.disabled=E=null==e[4],m($,"class","svelte-zn3s74"),q.src!==(W="load-icon.svg")&&m(q,"src","load-icon.svg"),m(q,"alt","load"),m(q,"class","svelte-zn3s74"),m(K,"id","load"),m(K,"aria-current",L="load-dict"==e[0]),K.disabled=z=null==e[4],m(K,"class","svelte-zn3s74"),m(p,"class","svelte-zn3s74"),m(n,"class","svelte-zn3s74"),m(J,"href","https://github.com/antoniusf/steno-lookup"),m(J,"target","_blank"),m(j,"id","version-info"),m(j,"class","svelte-zn3s74"),m(t,"id","container"),m(t,"class","svelte-zn3s74")},m(o,a){l(o,t,a),i(t,n),i(n,r),i(r,s),i(n,c),i(n,p),i(p,y),i(y,v),i(p,_),i(p,$),i($,x),i(p,T),i(p,K),i(K,q),i(K,U),ne&&ne.m(K,null),i(t,O),i(t,P),~C&&re[C].m(P,null),i(t,F),i(t,j),i(j,H),i(j,Y),i(j,G),i(j,I),i(j,X),i(j,Z),i(j,J),Q=!0,V||(ee=[h(y,"click",e[7]),h($,"click",e[8]),h(K,"click",e[6])],V=!0)},p(e,[t]){(!Q||1&t)&&te!==(te=e[5][e[0]]+"")&&g(s,te),(!Q||1&t&&b!==(b="query"==e[0]))&&m(y,"aria-current",b),(!Q||16&t&&k!==(k=null==e[4]))&&(y.disabled=k),(!Q||1&t&&S!==(S="find-stroke"==e[0]))&&m($,"aria-current",S),(!Q||16&t&&E!==(E=null==e[4]))&&($.disabled=E),e[2].new_version&&"unknown"!=e[2].user_knows_about_this_version&&e[2].user_knows_about_this_version!=e[2].new_version?ne||(ne=Ge(),ne.c(),ne.m(K,null)):ne&&(ne.d(1),ne=null),(!Q||1&t&&L!==(L="load-dict"==e[0]))&&m(K,"aria-current",L),(!Q||16&t&&z!==(z=null==e[4]))&&(K.disabled=z);let n=C;C=se(e),C===n?~C&&re[C].p(e,t):(B&&(M(),R(re[n],1,1,()=>{re[n]=null}),N()),~C?(B=re[C],B||(B=re[C]=oe[C](e),B.c()),D(B,1),B.m(P,null)):B=null),(!Q||8&t)&&g(I,e[3])},i(e){Q||(D(B),Q=!0)},o(e){R(B),Q=!1},d(e){e&&a(t),ne&&ne.d(),~C&&re[C].d(),V=!1,o(ee)}}}function nt(e,t,n){let o="load-dict",r="initializing",s={},i="(unknown)",l=null;const a=Symbol("version_unknown");J("user-knows-about-this-version").then(e=>{n(2,s.user_knows_about_this_version=e||a,s)}),"serviceWorker"in navigator&&(navigator.serviceWorker.register("serviceworker.js").then(e=>{console.log("Service worker registration successful.")}).catch(e=>{console.log("Service worker registration failed: "+e)}),navigator.serviceWorker.addEventListener("message",e=>{"version-info"==e.data.type?n(3,i=e.data.serviceworker_version):"update-info"==e.data.type?(s.user_knows_about_this_version==a&&(n(2,s.user_knows_about_this_version=e.data.current_version,s),Q("user-knows-about-this-version",e.data.current_version)),"up-to-date"==e.data.status?n(2,s.update_available=!1,s):"available"==e.data.status?(n(2,s.update_available=!0,s),n(2,s.new_version=e.data.new_version,s),"load-dict"==o&&"initializing"!=r&&"reading"!=r&&(n(2,s.user_knows_about_this_version=e.data.new_version,s),Q("user-knows-about-this-version",e.data.new_version))):"installed"==e.data.status&&(n(2,s.update_available=!1,s),n(2,s.user_knows_about_this_version=e.data.version,s),Q("user-knows-about-this-version",e.data.version),window.location.reload()),n(2,s.date_checked=e.data.date_checked,s),n(2,s.update_size=e.data.update_size,s),n(2,s.new_version=e.data.new_version,s),console.log(JSON.stringify(s,null,2))):"serviceworker-info"==e.data.type&&(n(2,s.serviceworker_info=e.data.text,s),console.log(s.serviceworker_info))}),navigator.serviceWorker.controller&&(navigator.serviceWorker.controller.postMessage("get-version"),navigator.serviceWorker.controller.postMessage("get-update-info"),navigator.serviceWorker.controller.postMessage("check-for-updates")));return[o,r,s,i,l,{"load-dict":"Load",query:"Lookup","find-stroke":"Find Stroke"},async function(e){"load-dict"!=o&&(n(0,o="load-dict"),s.new_version&&s.user_knows_about_this_version!=s.new_version&&(n(2,s.user_knows_about_this_version=s.new_version,s),await Q("user-knows-about-this-version",s.new_version)))},e=>{n(0,o="query")},e=>{n(0,o="find-stroke")},function(e){l=e,n(4,l)},function(e){s=e,n(2,s)},function(e){r=e,n(1,r)},function(e){o=e,n(0,o)},function(e){l=e,n(4,l)},function(e){l=e,n(4,l)}]}return new class extends I{constructor(e){super(),G(this,e,nt,tt,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
